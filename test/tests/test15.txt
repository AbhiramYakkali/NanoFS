# Test save and open commands with multi-line and multi-block files

SEND init
EXPECT
Initialized NanoFS system: nanofs_disk

SEND create smallfile
EXPECT
Created new file smallfile, inode 1, data block 1

SEND save small_input.txt smallfile
EXPECT
Copying from small_input.txt to smallfile, inode 1
Wrote 79 bytes to data block 1
Finished copying. Wrote 79 bytes total

SEND read smallfile
EXPECT
This is a test file.
It has multiple lines.
Line three here.
And a fourth line!
Read 79 bytes from file smallfile, inode 1, data block 1

SEND open smallfile
EXPECT
Copying smallfile, inode 1, into real filesystem
Read 79 bytes from data block 1
Finished copying. Wrote 79 bytes total to smallfile.txt

FILE_VERIFY smallfile.txt small_input.txt

SEND create largefile
EXPECT
Created new file largefile, inode 2, data block 2

SEND save large_input.txt largefile
EXPECT
Copying from large_input.txt to largefile, inode 2
Wrote 1024 bytes to data block 2
Wrote 1024 bytes to data block 3
Wrote 805 bytes to data block 4
Finished copying. Wrote 2853 bytes total

SEND open largefile
EXPECT
Copying largefile, inode 2, into real filesystem
Read 1024 bytes from data block 2
Read 1024 bytes from data block 3
Read 805 bytes from data block 4
Finished copying. Wrote 2853 bytes total to largefile.txt

FILE_VERIFY largefile.txt large_input.txt

SEND read largefile
EXPECT
BLOCK ONE - This file will span three data blocks to test multi-block handling.
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD
EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
Read 1024 bytes from file largefile, inode 2, data block 2
